<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تحميل التطبيق</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="icon" href="https://k.top4top.io/p_35326d4d31.jpg" type="image/png">
<style>
:root{--bg-primary:#121212;--bg-secondary:#1e1e1e;--bg-tertiary:#252525;--text-primary:#e0e0e0;--text-secondary:#a0a0a0;--accent:#4CAF50;--accent-hover:#3e8e41;--error:#ff4d4d}
body{background:var(--bg-primary);color:var(--text-primary);font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:0;padding:10px;line-height:1.6}
.container{max-width:900px;margin:auto}
.app-card{background:var(--bg-secondary);border-radius:10px;padding:25px;margin-bottom:20px}
.app-header{display:flex;align-items:center;gap:20px;margin-bottom:15px}
.app-header img{width:80px;height:80px;border-radius:16px;object-fit:cover;border:2px solid var(--bg-tertiary)}
.app-title{margin:0;color:var(--accent);font-size:24px}
.app-developer{margin:5px 0 0 0;color:var(--text-secondary);font-size:14px}
.meta-scroll-container{margin-bottom:20px;overflow-x:auto;white-space:nowrap;padding:10px 0;-ms-overflow-style:none;scrollbar-width:none}
.meta-scroll-container::-webkit-scrollbar{display:none}
.app-meta{display:inline-flex;gap:20px;background:var(--bg-tertiary);padding:10px 15px;border-radius:8px;font-size:14px;color:var(--text-secondary)}
.app-meta span{white-space:nowrap}
.download-btn{display:flex;align-items:center;justify-content:center;width:100%;padding:15px;background-color:var(--accent);color:white;text-align:center;border-radius:8px;font-size:18px;font-weight:bold;text-decoration:none;margin:20px 0;transition:background-color .3s;border:none;cursor:pointer;gap:10px}
.download-btn:hover{background-color:var(--accent-hover)}
.download-btn .loading{display:none;width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:spin 1s ease-in-out infinite}
.download-btn.loading .text{display:none}
.download-btn.loading .loading{display:block}
.section-title{font-size:18px;color:var(--accent);margin:25px 0 15px 0;padding-bottom:8px;border-bottom:1px solid var(--bg-tertiary)}
.screenshots-container{margin:20px 0;overflow-x:auto;padding:10px 0;-ms-overflow-style:none;scrollbar-width:none}
.screenshots-container::-webkit-scrollbar{display:none}
.screenshots-scroll{display:flex;gap:15px}
.screenshot{height:150px;border-radius:8px;object-fit:contain;flex-shrink:0}
.description{margin:20px 0;line-height:1.8;padding:15px;background:var(--bg-tertiary);border-radius:8px}
.divider{height:1px;background:var(--bg-tertiary);margin:25px 0}
.social-box,.notes-box,.share-box{background:var(--bg-tertiary);padding:15px;border-radius:8px;margin-top:20px}
.social-title,.notes-title,.share-title{font-size:16px;color:var(--accent);margin:0 0 15px 0}
.social-links{display:flex;flex-direction:column;gap:10px}
.social-link{display:flex;align-items:center;gap:10px;padding:12px 15px;background-color:rgba(255,255,255,.1);border-radius:8px;text-decoration:none;color:var(--text-primary);transition:background-color .3s;font-size:14px}
.social-link:hover{background-color:rgba(255,255,255,.2)}
.social-icon{width:20px;text-align:center}
.share-buttons{display:flex;gap:10px;flex-wrap:wrap}
.share-btn{display:flex;align-items:center;justify-content:center;gap:8px;flex:1;min-width:120px;padding:12px 15px;background-color:rgba(255,255,255,.1);border:none;border-radius:8px;color:var(--text-primary);cursor:pointer;transition:background-color .3s;font-size:14px}
.share-btn:hover{background-color:rgba(255,255,255,.2)}
.share-btn.copy:hover{background-color:var(--accent)}
.share-btn.share:hover{background-color:#1a73e8}
.error-message{text-align:center;padding:40px;background-color:var(--bg-secondary);border-radius:10px;color:var(--error);margin-bottom:20px}
.error-message i{font-size:48px;margin-bottom:15px;display:block}
.error-message h2{margin:0 0 15px 0;font-size:24px}
.error-message p{margin:0 0 25px 0;color:var(--text-secondary)}
.app-menu-btn{display:block;padding:15px;background-color:var(--accent);color:white;text-align:center;border-radius:8px;font-size:16px;font-weight:bold;text-decoration:none;transition:background-color .3s;border:none;cursor:pointer;width:fit-content;margin:0 auto}
.app-menu-btn:hover{background-color:var(--accent-hover)}
.loading{text-align:center;padding:40px;background-color:var(--bg-secondary);border-radius:10px}
.spinner{display:inline-block;width:40px;height:40px;border:4px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:var(--accent);animation:spin 1s ease-in-out infinite;margin-bottom:20px}
@keyframes spin{to{transform:rotate(360deg)}}
.footer{text-align:center;margin-top:40px;padding:15px;color:var(--text-secondary);font-size:14px}
</style>
</head>
<body>
<div class="container">
    <div id="appContent">
        <div class="loading">
            <div class="spinner"></div>
            <p>جاري تحميل بيانات التطبيق...</p>
        </div>
    </div>
</div>
<div class="footer">Powered by TAMAA PRO STUDIO</div>
<script>
const mainBin="https://api.jsonbin.io/v3/b/68b5a02ed0ea881f406e0b94";
const downloadsBin="https://api.jsonbin.io/v3/b/68b73b75d0ea881f406fa775";
const apiKey="$2a$10$F5TR7pSKPRRNAeBzsdxQ4.NYog8xHGUi0hektkor0q/QWFVXzba3q";
function getPackageFromUrl(){const q=window.location.search;return q.startsWith("?")?q.substring(1):null}
async function fetchBin(url){const res=await fetch(url,{headers:{"X-Master-Key":apiKey}});return res.json()}
async function updateDownloads(pkg){
    try{
        const d=await fetchBin(downloadsBin);
        let arr=d.record.applications_downloads||[];
        let record=arr.find(obj=>pkg in obj);
        if(!record){record={};record[pkg]="0";arr.push(record)}
        let count=parseInt(record[pkg])||0;
        count++;
        record[pkg]=count.toString();
        const updateResponse=await fetch(downloadsBin,{method:"PUT",headers:{"Content-Type":"application/json","X-Master-Key":apiKey},body:JSON.stringify({applications_downloads:arr})});
        const updateData=await updateResponse.json();
        let newRecord=updateData.record.applications_downloads.find(obj=>pkg in obj);
        return newRecord?newRecord[pkg]:0;
    }catch(error){return 0}
}
async function loadApp(){
const pkg=getPackageFromUrl();if(!pkg){document.getElementById("appContent").innerHTML=`<div class="error-message"><i class="fas fa-exclamation-circle"></i><h2>لم يتم تحديد التطبيق</h2><p>يرجى التأكد من الرابط المستخدم للوصول إلى هذه الصفحة</p><a href="https://tamaa-pro.github.io/azro/tazazt/applications_menu" class="app-menu-btn">فتح قائمة التطبيقات المرفوعة</a></div>`;return}
try{
const data=await fetchBin(mainBin);const apps=data.record.applications;
const app=apps.find(a=>a.package===pkg);
if(!app){document.getElementById("appContent").innerHTML=`<div class="error-message"><i class="fas fa-exclamation-triangle"></i><h2>التطبيق غير موجود</h2><p>قد يكون التطبيق قد تم إزالته أو أن الرابط غير صحيح</p><a href="https://tamaa-pro.github.io/azro/tazazt/applications_menu" class="app-menu-btn">فتح قائمة التطبيقات المرفوعة</a></div>`;return}
let downloads=0;
try{
    const dData=await fetchBin(downloadsBin);
    if(Array.isArray(dData.record.applications_downloads)){
        const rec=dData.record.applications_downloads.find(obj=>pkg in obj);
        if(rec){downloads=parseInt(rec[pkg])||0}
    }
}catch(error){downloads=0}
let content=`<div class="app-card"><div class="app-header"><img src="${app.icon}" alt="icon"><div><h2 class="app-title">${app.name}</h2><p class="app-developer">${app.developer}</p></div></div><div class="meta-scroll-container"><div class="app-meta"><span>التحميلات: ${downloads}</span><span>الإصدار: ${app.version}</span><span>تاريخ الإصدار: ${app.releaseDate}</span></div></div><button class="download-btn" id="downloadBtn"><span class="text">تحميل التطبيق</span><div class="loading"></div></button>`;
if(app.screenshots&&app.screenshots.length>0){content+=`<h3 class="section-title">لقطات الشاشة</h3><div class="screenshots-container"><div class="screenshots-scroll">${app.screenshots.map(s=>`<img src="${s}" class="screenshot">`).join("")}</div></div>`}
content+=`<div class="description">${app.longDesc}</div><div class="divider"></div>`;
if(app.extraInfo){content+=`<div class="notes-box"><h3 class="notes-title">ملاحظات المطور</h3><p>${app.extraInfo}</p></div>`}
if(app.social&&app.social.length>0){content+=`<div class="social-box"><h3 class="social-title">وسائل التواصل</h3><div class="social-links">${app.social.map(s=>{const socialInfo=getSocialInfo(s);return `<a href="${s}" target="_self" class="social-link"><span class="social-icon">${socialInfo.icon}</span><span>${socialInfo.name}</span></a>`}).join("")}</div></div>`}

content+=`<div class="share-box"><h3 class="share-title">مشاركة التطبيق</h3><div class="share-buttons"><button class="share-btn copy" id="copyLinkBtn"><i class="fas fa-copy"></i> نسخ الرابط</button><button class="share-btn share" id="shareLinkBtn"><i class="fas fa-share-alt"></i> مشاركة</button></div></div>`;
content+=`</div>`;
document.getElementById("appContent").innerHTML=content;
document.getElementById("downloadBtn").addEventListener("click",async function(){const btn=this;const textSpan=btn.querySelector('.text');textSpan.innerHTML='<i class="fas fa-spinner fa-spin"></i> جاري التحميل...';const newCount=await updateDownloads(pkg);document.querySelector('.app-meta span:first-child').textContent=`التحميلات: ${newCount}`;setTimeout(()=>{window.location.href=app.download},1000)});

document.getElementById('copyLinkBtn').addEventListener('click', copyPageLink);
document.getElementById('shareLinkBtn').addEventListener('click', sharePageLink);
}catch(err){document.getElementById("appContent").innerHTML=`<div class="error-message"><i class="fas fa-exclamation-triangle"></i><h2>خطأ في جلب البيانات</h2><p>حدث خطأ أثناء تحميل معلومات التطبيق</p></div>`}}
function getSocialInfo(url){if(url.includes('facebook.com'))return{icon:'<i class="fab fa-facebook"></i>',name:'فيسبوك'};if(url.includes('twitter.com')||url.includes('x.com'))return{icon:'<i class="fab fa-twitter"></i>',name:'تويتر'};if(url.includes('instagram.com'))return{icon:'<i class="fab fa-instagram"></i>',name:'إنستغرام'};if(url.includes('youtube.com'))return{icon:'<i class="fab fa-youtube"></i>',name:'يوتيوب'};if(url.includes('t.me'))return{icon:'<i class="fab fa-telegram"></i>',name:'تلغرام'};if(url.includes('whatsapp.com'))return{icon:'<i class="fab fa-whatsapp"></i>',name:'واتساب'};if(url.includes('linkedin.com'))return{icon:'<i class="fab fa-linkedin"></i>',name:'لينكدإن'};if(url.includes('github.com'))return{icon:'<i class="fab fa-github"></i>',name:'جيت هاب'};if(url.includes('discord.com')||url.includes('discord.gg'))return{icon:'<i class="fab fa-discord"></i>',name:'ديسكورد'};if(url.includes('tiktok.com'))return{icon:'<i class="fab fa-tiktok"></i>',name:'تيك توك'};if(url.includes('snapchat.com'))return{icon:'<i class="fab fa-snapchat"></i>',name:'سناب شات'};return{icon:'<i class="fas fa-globe"></i>',name:'موقع ويب'}}

function copyPageLink() {
    const pageUrl = window.location.href;
    navigator.clipboard.writeText(pageUrl).then(() => {
        const btn = document.getElementById('copyLinkBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> تم النسخ!';
        btn.style.backgroundColor = 'var(--accent)';
        setTimeout(() => {
            btn.innerHTML = originalText;
            btn.style.backgroundColor = '';
        }, 2000);
    }).catch(err => {
        alert('تعذر نسخ الرابط: ' + err);
    });
}

function sharePageLink() {
    const pageUrl = window.location.href;
    const pageTitle = document.querySelector('.app-title')?.textContent || 'تطبيق';
    
    if (navigator.share) {
        navigator.share({
            title: pageTitle,
            url: pageUrl
        }).catch(err => {
            console.log('خطأ في المشاركة:', err);
        });
    } else {
        
        copyPageLink();
        const btn = document.getElementById('shareLinkBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> تم النسخ!';
        btn.style.backgroundColor = 'var(--accent)';
        setTimeout(() => {
            btn.innerHTML = originalText;
            btn.style.backgroundColor = '';
        }, 2000);
    }
}
loadApp();
</script>
<script>

document.addEventListener('DOMContentLoaded', function() {
    const downloadBtn = document.getElementById('downloadBtn');
    
    if (downloadBtn) {
        downloadBtn.addEventListener('click', function() {
            
            this.disabled = true;
        });
    }
});

</script>
<script>
document.addEventListener('wheel', function(e) {if (e.ctrlKey) e.preventDefault();}, { passive: false });document.addEventListener('keydown', function(e) {if ((e.ctrlKey && (e.key === '+' || e.key === '-' || e.key === '=')) || e.key === 'Meta') {e.preventDefault();}});document.addEventListener('contextmenu', e => e.preventDefault());document.addEventListener('selectstart', function(e) {e.preventDefault();});document.addEventListener('copy', function(e) {e.preventDefault();});
document.addEventListener('keydown', function(e) {if ((e.ctrlKey || e.metaKey) && 
(e.key === '+' || e.key === '-' || e.key === '0' || e.keyCode === 187 || e.keyCode === 189 || e.keyCode === 48)) {e.preventDefault();}});document.addEventListener('wheel', function(e) {if (e.ctrlKey) {e.preventDefault();}}, { passive: false });let lastTouchEnd = 0;document.addEventListener('touchstart', function(e) {if (e.touches.length > 1) {e.preventDefault();}});document.addEventListener('touchend', function(e) {const now = Date.now();if (now - lastTouchEnd <= 300) {e.preventDefault();}
lastTouchEnd = now;}, { passive: false });document.addEventListener('touchmove', function(e) {if (e.touches.length > 1) {e.preventDefault();}}, { passive: false });document.addEventListener('dblclick', function(e) {e.preventDefault();}, { passive: false });const viewportMeta = document.querySelector('meta[name="viewport"]');viewportMeta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
</script>
</body>
</html>
