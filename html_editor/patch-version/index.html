<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
*{box-sizing:border-box}

html,body{
    margin:0;
    padding:0;
    width:100%;
    height:100%;
    overflow:hidden;
    background:#000;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
}

/* الشريط */
#toolbar{
    position:fixed;
    top:0;left:0;right:0;
    height:48px;
    background:#111;
    display:flex;
    align-items:center;
    gap:10px;
    padding:0 8px;
    z-index:10;
}

#toolbar button{
    background:none;
    border:none;
    color:#fff;
    font-size:16px;
    cursor:pointer;
}

/* المحرر */
#editor{
    position:fixed;
    top:48px;left:0;right:0;bottom:0;
    background:#000;
    color:#fff;
    border:none;
    outline:none;
    resize:none;
    padding:3px;
    font-size:15px;
    font-family:inherit;
    direction:ltr;
    white-space:pre-wrap;
    word-wrap:break-word;
    overflow:auto;
}

/* التضبيب */
#overlay{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.4);
    backdrop-filter:blur(6px);
    display:none;
    z-index:20;
}

/* نافذة الإعدادات */
#settingsBox{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:#222;
    width:300px;
    padding:12px;
    display:none;
    z-index:30;
}

#settingsBox header button{
    background:none;
    border:none;
    color:#fff;
    font-size:16px;
}

.divider{height:1px;background:#333;margin:10px 0}

.setting{margin-bottom:8px}
.setting label{color:#ccc;font-size:12px}
.setting input,.setting select{
    width:100%;
    background:#111;
    color:#fff;
    border:1px solid #333;
    padding:6px;
}

.btn{
    width:100%;
    background:#111;
    color:#fff;
    border:1px solid #333;
    padding:7px;
    cursor:pointer;
    margin-bottom:6px;
}

.hidden{display:none}
</style>
</head>

<body>

<div id="toolbar">
    <button onclick="copyText()"><i class="fa-solid fa-copy"></i></button>
    <button onclick="cutText()"><i class="fa-solid fa-scissors"></i></button>
    <button onclick="pasteText()"><i class="fa-solid fa-paste"></i></button>
    <button onclick="clearAll()"><i class="fa-solid fa-trash"></i></button>
    <button onclick="undo()"><i class="fa-solid fa-rotate-left"></i></button>
    <button onclick="redo()"><i class="fa-solid fa-rotate-right"></i></button>
    <button onclick="goStart()"><i class="fa-solid fa-angles-up"></i></button>
    <button onclick="goEnd()"><i class="fa-solid fa-angles-down"></i></button>
    <button onclick="openSettings()"><i class="fa-solid fa-gear"></i></button>
</div>

<textarea id="editor"></textarea>

<div id="overlay"></div>

<div id="settingsBox">
<header><button onclick="closeSettings()"><i class="fa-solid fa-xmark"></i></button></header>

<button class="btn" onclick="runCode()">تشغيل الكود</button>

<div class="divider"></div>

<div class="setting">
<label>نوع الخط</label>
<select id="fontFamily">
<option value="inherit">عادي</option>
<option value="monospace">Monospace</option>
<option value="Arial">Arial</option>
<option value="Tahoma">Tahoma</option>
<option value="Verdana">Verdana</option>
<option value="Courier New">Courier New</option>
<option value="Times New Roman">Times New Roman</option>
<option value="Georgia">Georgia</option>
<option value="Segoe UI">Segoe UI</option>
<option value="sans-serif">Sans-serif</option>
</select>
</div>
</div>

<script>
const editor=document.getElementById("editor");
const overlay=document.getElementById("overlay");
const settingsBox=document.getElementById("settingsBox");
const fontFamily=document.getElementById("fontFamily");

editor.value=sessionStorage.getItem("code")||"";
editor.oninput=()=>sessionStorage.setItem("code",editor.value);

fontFamily.onchange=()=>editor.style.fontFamily=fontFamily.value;

function openSettings(){overlay.style.display="block";settingsBox.style.display="block"}
function closeSettings(){overlay.style.display="none";settingsBox.style.display="none"}

function copyText(){
    navigator.clipboard.writeText(
        editor.selectionStart!==editor.selectionEnd
        ?editor.value.slice(editor.selectionStart,editor.selectionEnd)
        :editor.value
    );
}

function pasteText(){
    const tmp=document.createElement("input");
    tmp.style.position="fixed";
    tmp.style.opacity="0";
    document.body.appendChild(tmp);
    tmp.focus();
    document.execCommand("paste");
    if(tmp.value){
        editor.setRangeText(tmp.value,editor.selectionStart,editor.selectionEnd,"end");
    }
    document.body.removeChild(tmp);
}

function cutText(){
    copyText();
    editor.setRangeText("",editor.selectionStart,editor.selectionEnd,"start");
}

function clearAll(){editor.value=""}
function undo(){document.execCommand("undo")}
function redo(){document.execCommand("redo")}
function goStart(){editor.setSelectionRange(0,0)}
function goEnd(){editor.setSelectionRange(editor.value.length,editor.value.length)}

function runCode(){
    sessionStorage.setItem("code",editor.value);
    const blob=new Blob([editor.value],{type:"text/html"});
    location.href=URL.createObjectURL(blob);
}
</script>

</body>
</html>
